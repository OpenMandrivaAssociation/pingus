From 90b645cee25f2d6b8809bd151e025939278240d5 Mon Sep 17 00:00:00 2001
From: Ingo Ruhnke <grumbel@gmail.com>
Date: Sun, 27 Jul 2014 05:01:44 +0200
Subject: [PATCH 075/129] Added logmich includes

---
 SConscript                  |   5 +-
 src/editor/editor_level.cpp |   1 +
 src/util/log.cpp            |  94 ------------------------
 src/util/log.hpp            | 142 +++++-------------------------------
 4 files changed, 25 insertions(+), 217 deletions(-)
 delete mode 100644 src/util/log.cpp

diff --git a/SConscript b/SConscript
index c4d25a8a9..c824b3cf3 100644
--- a/SConscript
+++ b/SConscript
@@ -230,10 +230,13 @@ class Project:
         self.conf.CheckLib('iconv')
 
     def build(self):
-        self.env.Append(CPPPATH = ['.', 'src/', 'external/tinygettext/'])
+        self.env.Append(CPPPATH = ['.', 'src/',
+                                   'external/tinygettext/',
+                                   'external/logmich/include/'])
 
         libpingus = self.env.StaticLibrary('pingus',
                                            Glob('external/tinygettext/tinygettext/*.cpp') + \
+                                           Glob('external/logmich/src/*.cpp') + \
                                            Glob('src/editor/*.cpp') + \
                                            Glob('src/engine/display/*.cpp') + \
                                            Glob('src/engine/display/delta/*.cpp') + \
diff --git a/src/editor/editor_level.cpp b/src/editor/editor_level.cpp
index fd8b9253b..ab8cc3842 100644
--- a/src/editor/editor_level.cpp
+++ b/src/editor/editor_level.cpp
@@ -18,6 +18,7 @@
 #include "editor/editor_level.hpp"
 
 #include <algorithm>
+#include <sstream>
 
 #include "editor/level_obj.hpp"
 #include "editor/level_obj_factory.hpp"
diff --git a/src/util/log.cpp b/src/util/log.cpp
deleted file mode 100644
index 7a7d2a348..000000000
--- a/src/util/log.cpp
+++ /dev/null
@@ -1,94 +0,0 @@
-/*
-**  Xbox360 USB Gamepad Userspace Driver
-**  Copyright (C) 2011 Ingo Ruhnke <grumbel@gmx.de>
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-*/
-
-#include <iostream>
-
-#include "log.hpp"
-
-Logger g_logger;
-
-std::string log_pretty_print(const std::string& str)
-{
-  // FIXME: very basic, might not work with complex return types
-  std::string::size_type function_start = 0;
-  for(std::string::size_type i = 0; i < str.size(); ++i)
-  {
-    if (str[i] == ' ')
-    {
-      function_start = i+1;
-    }
-    else if (str[i] == '(')
-    {
-      return str.substr(function_start, i - function_start) + "()";
-    }
-  }
-
-  return str.substr(function_start);
-}
-
-Logger::Logger() :
-  m_log_level(kWarning)
-{}
-
-void
-Logger::incr_log_level(LogLevel level)
-{
-  if (get_log_level() < level)
-  {
-    set_log_level(level);    
-  }
-}
-
-void
-Logger::set_log_level(LogLevel level)
-{
-  m_log_level = level;
-}
-
-Logger::LogLevel
-Logger::get_log_level() const
-{
-  return m_log_level;
-}
-
-void
-Logger::append_unchecked(LogLevel level, const std::string& str)
-{
-  switch(level)
-  {
-    case kNone:    std::cout << "[NONE]  "; break;
-    case kError:   std::cout << "[ERROR] "; break;
-    case kWarning: std::cout << "[WARN]  "; break;
-    case kInfo:    std::cout << "[INFO]  "; break;
-    case kDebug:   std::cout << "[DEBUG] "; break;
-    case kTemp:    std::cout << "[TEMP]  "; break;
-  }
-    
-  std::cout << str << std::endl;
-}
-
-void
-Logger::append(LogLevel level, const std::string& str) 
-{
-  if (m_log_level >= level)
-  {
-    append_unchecked(level, str);
-  }
-}
-
-/* EOF */
diff --git a/src/util/log.hpp b/src/util/log.hpp
index b5bb95887..80ec56f31 100644
--- a/src/util/log.hpp
+++ b/src/util/log.hpp
@@ -1,125 +1,23 @@
-/*
-**  Xbox360 USB Gamepad Userspace Driver
-**  Copyright (C) 2011 Ingo Ruhnke <grumbel@gmx.de>
-**
-**  This program is free software: you can redistribute it and/or modify
-**  it under the terms of the GNU General Public License as published by
-**  the Free Software Foundation, either version 3 of the License, or
-**  (at your option) any later version.
-**
-**  This program is distributed in the hope that it will be useful,
-**  but WITHOUT ANY WARRANTY; without even the implied warranty of
-**  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-**  GNU General Public License for more details.
-**
-**  You should have received a copy of the GNU General Public License
-**  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-*/
-
-#ifndef HEADER_XBOXDRV_LOG_HPP
-#define HEADER_XBOXDRV_LOG_HPP
-
-#include <string>
-#include <sstream>
-
-/** Takes __PRETTY_FUNCTION__ and tries to shorten it to the form:
-    Classname::function() */
-std::string log_pretty_print(const std::string& str);
-
-class Logger
-{
-public:
-  enum LogLevel {
-    /** Used in set_log_level() to disable all output */
-    kNone,
-
-    /** things that shouldn't happen (i.e. a catched exceptions) */
-    kError,
-
-    /** messages that indicate an recoverable error (i.e. a catched
-        exceptions) */
-    kWarning,
-
-    /** informal status messages that don't indicate a fault in the
-        program */
-    kInfo,
-
-    /** extra verbose debugging messages */
-    kDebug,
-
-    /** temporary extra verbose debugging messages */
-    kTemp
-  };
-
-private:
-  LogLevel m_log_level;
-
-public:
-  Logger();
-  void incr_log_level(LogLevel level);
-  void set_log_level(LogLevel level);
-  LogLevel get_log_level() const;
-  void append(LogLevel level, const std::string& str);
-  void append_unchecked(LogLevel level, const std::string& str);
-
-};
-
-#define log_debug(text) do { \
-  if (g_logger.get_log_level() >= Logger::kDebug) \
-  { \
-    std::ostringstream x6ac1c382;             \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__) << ": " << text; \
-    g_logger.append_unchecked(Logger::kDebug, x6ac1c382.str()); \
-  } \
-} while(false)
-
-#define log_info(text) do { \
-  if (g_logger.get_log_level() >= Logger::kInfo) \
-  { \
-    std::ostringstream x6ac1c382;             \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__) << ": " << text; \
-    g_logger.append_unchecked(Logger::kInfo, x6ac1c382.str()); \
-  } \
-} while(false)
-
-#define log_warn(text) do { \
-  if (g_logger.get_log_level() >= Logger::kWarning) \
-  { \
-    std::ostringstream x6ac1c382;             \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__) << ": " << text; \
-    g_logger.append_unchecked(Logger::kWarning, x6ac1c382.str()); \
-  } \
-} while(false)
-
-#define log_error(text) do { \
-  if (g_logger.get_log_level() >= Logger::kError) \
-  { \
-    std::ostringstream x6ac1c382;             \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__) << ": " << text; \
-    g_logger.append_unchecked(Logger::kError, x6ac1c382.str()); \
-  } \
-} while(false)
-
-/** Write an empty debug message, thus only class and function
-    name are visible, log level is ignored, messages are always
-    printed. Use for temporary messages in development that should not
-    be part of final release. */
-#define log_tmp_trace() do { \
-    std::ostringstream x6ac1c382; \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__); \
-    g_logger.append_unchecked(Logger::kTemp, x6ac1c382.str()); \
-} while(false)
-
-/** Write an debug message, while ignoring the log level. Use for
-    temporary messages in development that should not be part of final
-    release. */
-#define log_tmp(text) do { \
-    std::ostringstream x6ac1c382; \
-    x6ac1c382 << log_pretty_print(__PRETTY_FUNCTION__) << ": " << text; \
-    g_logger.append_unchecked(Logger::kTemp, x6ac1c382.str()); \
-} while(false)
-
-extern Logger g_logger;
+//  Pingus - A free Lemmings clone
+//  Copyright (C) 2014 Ingo Ruhnke <grumbel@gmx.de>
+//
+//  This program is free software: you can redistribute it and/or modify
+//  it under the terms of the GNU General Public License as published by
+//  the Free Software Foundation, either version 3 of the License, or
+//  (at your option) any later version.
+//  
+//  This program is distributed in the hope that it will be useful,
+//  but WITHOUT ANY WARRANTY; without even the implied warranty of
+//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+//  GNU General Public License for more details.
+//  
+//  You should have received a copy of the GNU General Public License
+//  along with this program.  If not, see <http://www.gnu.org/licenses/>.
+
+#ifndef HEADER_PINGUS_UTIL_LOG_HPP
+#define HEADER_PINGUS_UTIL_LOG_HPP
+
+#include <logmich/log.hpp>
 
 #endif
 
-- 
2.51.2

